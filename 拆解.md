● 專案程式解析 - 給新人的快速入門指南

  ---
  📁 專案結構

  peggy-pyqt/
  ├── main_pyqt.py    ← 加密記事本應用程式 (主要)
  ├── main.py         ← 倒數計時器應用程式
  └── page*_auto_save.txt  ← 加密的筆記資料檔 (執行後產生)

  ---
  🔐 應用程式一：加密記事本 (main_pyqt.py)

  功能概述

  這是一個具有 密碼保護 的記事本，支援 20 個分頁，並可透過 Git 同步到遠端。

  啟動流程圖

  ┌─────────────────────────────────────────────────────────────────┐
  │                        程式啟動                                  │
  └─────────────────────────────────────────────────────────────────┘
                                │
                                ▼
  ┌─────────────────────────────────────────────────────────────────┐
  │                 prompt_password()                                │
  │                   顯示密碼輸入框                                  │
  └─────────────────────────────────────────────────────────────────┘
                                │
                                ▼
                      ┌─────────────────┐
                      │  使用者輸入密碼  │
                      └─────────────────┘
                                │
                                ▼
  ┌─────────────────────────────────────────────────────────────────┐
  │  密碼 → SHA-256 雜湊 → Base64 編碼 → Fernet 加密金鑰            │
  └─────────────────────────────────────────────────────────────────┘
                                │
                                ▼
                      ┌─────────────────┐
                      │ 嘗試解密 page1  │
                      └─────────────────┘
                                │
                ┌───────────────┴───────────────┐
                ▼                               ▼
          ┌──────────┐                    ┌──────────┐
          │ 解密成功  │                    │ 解密失敗  │
          └──────────┘                    └──────────┘
                │                               │
                ▼                               ▼
      ┌──────────────────┐              ┌──────────────────┐
      │ 建立 MainWindow  │              │  顯示錯誤訊息     │
      │   開啟主視窗      │              │  要求重新輸入     │
      └──────────────────┘              └──────────────────┘

  主視窗初始化流程

  ┌─────────────────────────────────────────────────────────────────┐
  │                    MainWindow.__init__()                         │
  └─────────────────────────────────────────────────────────────────┘
                                │
          ┌─────────────────────┼─────────────────────┐
          ▼                     ▼                     ▼
  ┌──────────────┐    ┌──────────────────┐    ┌──────────────────┐
  │  init_ui()   │    │check_and_create_ │    │ load_saved_text()│
  │  建立 UI 元件 │    │     files()      │    │   載入第一頁     │
  └──────────────┘    │ 確保20個檔案存在  │    └──────────────────┘
                      └──────────────────┘
                                │
                                ▼
                ┌───────────────────────────────┐
                │  啟動 Git 檢查 (QTimer)        │
                │  - 啟動時檢查一次              │
                │  - 每10分鐘自動檢查            │
                └───────────────────────────────┘

  UI 結構圖

  ┌─────────────────────────────────────────────────────────────────┐
  │  記事本 V8.5      Power by STK-KUO                    [─][□][✕] │
  ├─────────────────────────────────────────────────────────────────┤
  │ 工具列: [💾存檔] [📍釘選] [🔠字體] [🔍搜尋] [🌐全搜] [▼分頁] [📤上傳] [📥下載] │
  ├─────────────────────────────────────────────────────────────────┤
  │                                                                 │
  │                      文字編輯區 (QTextEdit)                      │
  │                                                                 │
  │                     - 深色背景 (#3d3d3d)                         │
  │                     - 白色文字                                   │
  │                     - 自動換行                                   │
  │                                                                 │
  ├─────────────────────────────────────────────────────────────────┤
  │ 狀態列: [訊息顯示區]                              [Git 狀態: ✓]  │
  └─────────────────────────────────────────────────────────────────┘

  核心功能說明

  1. 加密機制 (main_pyqt.py:628-630)

  # 密碼轉換為加密金鑰的過程
  password = "使用者輸入"
  key = hashlib.sha256(password.encode()).digest()  # SHA-256 雜湊
  encryption_key = Fernet(base64.urlsafe_b64encode(key))  # 建立 Fernet 金鑰

  2. 自動儲存流程 (main_pyqt.py:390-402)

  ┌──────────────┐    每10秒     ┌──────────────┐
  │  QTimer 觸發  │ ──────────► │ auto_save()  │
  └──────────────┘              └──────────────┘
                                       │
                                       ▼
                            ┌─────────────────────┐
                            │ 內容有變更嗎？       │
                            └─────────────────────┘
                             │ 是              │ 否
                             ▼                 ▼
                      ┌─────────────┐    ┌──────────┐
                      │ save_text() │    │  不動作   │
                      │  加密並儲存  │    └──────────┘
                      └─────────────┘

  3. Git 同步狀態判斷 (main_pyqt.py:191-222)

                      ┌─────────────────┐
                      │   git fetch     │
                      │   取得遠端資訊   │
                      └─────────────────┘
                              │
                              ▼
              ┌───────────────────────────────┐
              │ 比較 local / remote / base    │
              └───────────────────────────────┘
                              │
      ┌───────────┬───────────┼───────────┬───────────┐
      ▼           ▼           ▼           ▼           ▼
  ┌────────┐ ┌────────┐ ┌────────┐ ┌────────┐ ┌────────┐
  │ 已同步  │ │遠端較新│ │本地較新│ │已分歧  │ │  錯誤  │
  │  ✓綠色  │ │ 🔄橘色 │ │ ↑黃色  │ │ ↔️紅色 │ │  紅色  │
  └────────┘ └────────┘ └────────┘ └────────┘ └────────┘

  ---

● ⏱️ 應用程式二：倒數計時器 (main.py)

  功能概述

  多重倒數計時器，可同時運行多個計時器，支援桌面通知與音效提醒。

  類別關係圖

  ┌─────────────────────────────────────────────────────────────────┐
  │                      CountdownApp                                │
  │                      (主視窗 QWidget)                            │
  ├─────────────────────────────────────────────────────────────────┤
  │  屬性:                                                           │
  │  - timer_count: 計時器數量                                       │
  │  - frames[]: 所有 TimerWidget 的列表                             │
  │  - sound_var: 是否啟用音效                                       │
  │  - notify_var: 是否啟用通知                                      │
  ├─────────────────────────────────────────────────────────────────┤
  │  方法:                                                           │
  │  - add_timers(): 新增 3 個計時器                                 │
  │  - remove_timer(): 移除指定計時器                                │
  │  - reposition_timers(): 重新排列網格                             │
  └─────────────────────────────────────────────────────────────────┘
                                │
                                │ 包含多個
                                ▼
  ┌─────────────────────────────────────────────────────────────────┐
  │                      TimerWidget                                 │
  │                   (單一計時器 QFrame)                            │
  ├─────────────────────────────────────────────────────────────────┤
  │  屬性:                                                           │
  │  - timer_id: 計時器編號                                          │
  │  - is_running: 是否執行中                                        │
  │  - remaining_time: 剩餘秒數                                      │
  │  - end_time: 預計結束時間                                        │
  ├─────────────────────────────────────────────────────────────────┤
  │  方法:                                                           │
  │  - start_timer(): 開始倒數                                       │
  │  - cancel_timer(): 取消倒數                                      │
  │  - reset_timer(): 重置計時器                                     │
  │  - time_up(): 時間到的處理                                       │
  └─────────────────────────────────────────────────────────────────┘

  UI 結構圖

  ┌─────────────────────────────────────────────────────────────────┐
  │  GleamTimerV7-By PCKuo                               [─][□][✕]  │
  ├─────────────────────────────────────────────────────────────────┤
  │  [選項 ▼]  [新增計時器]                                          │
  │   ├─ ☐ 置頂                                                     │
  │   ├─ ☑ 音效                                                     │
  │   └─ ☑ 通知                                                     │
  ├───────────────────────┬─────────────────────────────────────────┤
  │  ┌─────────────────┐  │  ┌─────────────────┐                    │
  │  │ 計時器 1    [X] │  │  │ 計時器 4    [X] │     ...            │
  │  │ 分鐘: [____]    │  │  │ 分鐘: [____]    │                    │
  │  │ 備註: [____]    │  │  │ 備註: [____]    │                    │
  │  │ ████████░░░░░░  │  │  │ ░░░░░░░░░░░░░░  │                    │
  │  │ 剩餘: 00:05:30  │  │  │ 剩餘: 00:00:00  │                    │
  │  │ 到期: 14:30:00  │  │  │ 到期: --:--:--  │                    │
  │  │[開始][取消][重置]│  │  │[開始][取消][重置]│                    │
  │  └─────────────────┘  │  └─────────────────┘                    │
  │  ┌─────────────────┐  │  ┌─────────────────┐                    │
  │  │ 計時器 2    [X] │  │  │ 計時器 5    [X] │                    │
  │  │      ...        │  │  │      ...        │                    │
  │  └─────────────────┘  │  └─────────────────┘                    │
  │  ┌─────────────────┐  │  ┌─────────────────┐                    │
  │  │ 計時器 3    [X] │  │  │ 計時器 6    [X] │                    │
  │  │      ...        │  │  │      ...        │                    │
  │  └─────────────────┘  │  └─────────────────┘                    │
  ├─────────────────────────────────────────────────────────────────┤
  │  [記事欄 - 多行文字輸入區]                                        │
  └─────────────────────────────────────────────────────────────────┘

  計時器運作流程

  ┌──────────────┐
  │  使用者點擊   │
  │   [開始]     │
  └──────────────┘
         │
         ▼
  ┌──────────────────────────────────────┐
  │  start_timer()                       │
  │  1. 讀取分鐘數                        │
  │  2. 計算 remaining_time (秒)          │
  │  3. 計算 end_time (結束時間)          │
  │  4. 啟動 QTimer (每秒觸發)            │
  └──────────────────────────────────────┘
         │
         ▼
  ┌──────────────────────────────────────┐
  │  update_timer() - 每秒執行            │
  │  1. remaining_time -= 1              │
  │  2. 更新進度條                        │
  │  3. 更新剩餘時間顯示                  │
  └──────────────────────────────────────┘
         │
         ▼
  ┌─────────────────┐
  │ remaining_time  │
  │    == 0 ?       │
  └─────────────────┘
      │ 是
      ▼
  ┌──────────────────────────────────────┐
  │  time_up()                           │
  │  1. 停止計時器                        │
  │  2. 發送桌面通知 (如啟用)             │
  │  3. 播放音效 (如啟用)                 │
  │  4. 進度條開始閃爍                    │
  └──────────────────────────────────────┘

  網格排列邏輯 (main.py:314-316)

  計時器編號 → 網格位置轉換：

  row = (timer_id - 1) % 3      ← 行 (0, 1, 2 循環)
  column = (timer_id - 1) // 3  ← 列 (每 3 個換一列)

  範例：
  ┌─────────┬─────────┬─────────┐
  │ 計時器1 │ 計時器4 │ 計時器7 │  row=0
  │ 計時器2 │ 計時器5 │ 計時器8 │  row=1
  │ 計時器3 │ 計時器6 │ 計時器9 │  row=2
  └─────────┴─────────┴─────────┘
    col=0     col=1     col=2

  ---
  ● 📚 關鍵技術總結

  PyQt5 常用元件對照表

  | 元件           | 用途             | 程式碼位置            |
  |--------------|----------------|------------------|
  | QMainWindow  | 主視窗 (有選單列、工具列) | main_pyqt.py:55  |
  | QWidget      | 基本視窗/容器        | main.py:214      |
  | QFrame       | 帶邊框的容器         | main.py:9        |
  | QTextEdit    | 多行文字編輯         | main_pyqt.py:107 |
  | QLineEdit    | 單行文字輸入         | main.py:56       |
  | QComboBox    | 下拉選單           | main_pyqt.py:167 |
  | QProgressBar | 進度條            | main.py:76       |
  | QTimer       | 定時器            | main_pyqt.py:187 |
  | QMessageBox  | 對話框            | main_pyqt.py:267 |

  信號與槽 (Signal & Slot) 機制

  # 基本語法：物件.信號.connect(槽函數)

  # 範例 1: 按鈕點擊
  save_action.triggered.connect(self.save_text)
  #          ↑ 信號              ↑ 槽函數

  # 範例 2: 定時器超時
  self.timer.timeout.connect(self.auto_save)

  # 範例 3: 下拉選單改變
  self.page_selector.currentIndexChanged.connect(self.switch_page)

  資料流程總圖

  ┌─────────────────────────────────────────────────────────────────┐
  │                     main_pyqt.py 資料流                          │
  └─────────────────────────────────────────────────────────────────┘

  使用者輸入            記憶體                  檔案系統
      │                   │                       │
      ▼                   ▼                       ▼
  ┌────────┐         ┌────────┐            ┌──────────────┐
  │ 密碼   │ ──────► │加密金鑰│ ◄────────► │ page*_auto_  │
  └────────┘         └────────┘            │  save.txt    │
                          │                └──────────────┘
                          ▼                       ▲
  ┌────────┐         ┌────────┐                   │
  │ 文字   │ ◄─────► │QTextEdit│ ◄──加密/解密──────┘
  │ 輸入   │         │ 編輯區  │
  └────────┘         └────────┘


  ┌─────────────────────────────────────────────────────────────────┐
  │                       main.py 資料流                             │
  └─────────────────────────────────────────────────────────────────┘

  使用者輸入            記憶體                  系統服務
      │                   │                       │
      ▼                   ▼                       ▼
  ┌────────┐         ┌────────────┐         ┌──────────┐
  │ 分鐘數 │ ──────► │TimerWidget │ ──────► │ 桌面通知  │
  │ 備註   │         │remaining_  │         │(plyer)   │
  └────────┘         │time        │         └──────────┘
                     └────────────┘               │
                          │                       ▼
                          │                 ┌──────────┐
                          └───────────────► │ 音效     │
                            (time_up)       │(winsound)│
                                            └──────────┘

  ---
  🚀 新人快速上手指南

  1. 環境設定

  # 安裝相依套件
  pip install PyQt5 cryptography plyer

  2. 執行程式

  # 記事本
  python main_pyqt.py

  # 計時器
  python main.py

  3. 程式碼修改建議入口點

  | 如果要...    | 修改位置                                       |
  |-----------|--------------------------------------------|
  | 修改記事本外觀   | COMMON_STYLESHEET (main_pyqt.py:16-53)     |
  | 調整自動儲存間隔  | self.timer.start(10000) (main_pyqt.py:189) |
  | 修改分頁數量    | PAGE_NAMES (main_pyqt.py:13)               |
  | 調整計時器大小   | setFixedSize(350, 180) (main.py:15)        |
  | 修改預設計時器數量 | add_timers() 中的 range(3) (main.py:308)     |

  ---